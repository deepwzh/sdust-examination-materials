# 2019数据库大题

<div   align='right'  style margin='10px 40px 15px 40px'><font  color= 'gray' size='4' >	By Zhihong Xu	</font></div>
##关系代数（10分）

1、投影：Π

> 从R中选择出若干属性列，组成新的关系（<u>重复行将会被取消</u>）

2、连接：从两个关系的笛卡儿积中选取属性间满足一定条件的元组。

>* 等值连接
>* 自然连接（特殊的等值连接，去掉重复列）

3、选择

<font color = 'red'>**4、除：至少考一处**</font>

​	Question：查询选了**全部课程**的学生学号

​	Abstract：查询使用了**某全部集合**的某集合的某属性

> 1、先求题目所定义的全部课程，设为C
>
> 2、用选课记录➗C，选课记录中包含**学号**和**课程号**

5、关系代数表达式与SQL语句的结合

## SQL语句（10分）

#### 一、基本操作

1、查询

> * 单表查询
>
>   * GROUP BY子句：将查询结果分组，细化聚集函数的作用对象
>   * HAVING：作用于GROUP BY分组的结果，进行组的筛选
>
> * 嵌套查询
>
>   * IN
>   * EXISTS
>
>   > 量词命题的否定：例如查询提供全部零件的供应商名字

2、插入

> INSERT INTO 表名（A1,A2,...）VALUES （）
>
> （A1,A2...)与题目要求保持一致性

3、删除

4、更新

**5、视图：作用、定义、使用**

#### 二、授权与撤销

> grant和remoke语句，重点是数据库角色（ROLE）的定义和使用。

#### 三、触发器的应用

> 传说魏永山出题会考，最好看一看。

## 关系数据理论 （15分）<font color= 'gray' size='4.5'>	范式、函数依赖、分解、闭包</font>

####关系分解类综合题目

1、计算候选码

> 围绕函数依赖左侧属性，不断尝试，直到找到一组属性可以完全决定属性集U。（其任何一个真子集，都不能完全确定U）

2、求最小依赖集合

> * 分解：右属性单一
>
> * 去掉冗余函数依赖：即去掉以后，是否依然**“等价”**。
>
>   **<font color = 'red'>保留传递依赖的过程，去掉传递依赖的结果。</font>**
>
> * 去掉左部分冗余属性

3、判断最高属于第几范式：

> 判断非主属性对码是否部分函数依赖，传递函数依赖。

4、依据算法分解：将R分解为3NF，且保持函数依赖并具有无损连接性。

依据算法6.3和算法6.4

在此之前，首先我们应该保证F为**最小依赖集合**（见第二条）。然后分解，两个重点，一个是不存在于F中的属性，一个是候选码要存在。

> 1、合并，合并左属性相同的依赖
>
> 2、检查不存在F中的属性，记作U0属性，构成关系模式R1（U0）
>
> **3、分解：把每一个函数依赖，作为一个子关系模式，将R分解为若干个子关系模式。**
>
> 4、检查候选码是否包含在分解后的关系模式中，如不，则将候选码作为一个新的关系模式
>
> 5、检查是否有覆盖**（属性的角度）**，若有，去掉。

3、如何构造是否无损连接？

> 1、根据分解和关系模式R构造一个关系
>
> * a+列号
> * b+行号+列号
>
> 2、**根据函数依赖**，修改表格。当发现有一个元组变成全a行时，证明该分解具有无损连接性。

## 关系代数查询优化 （15分）

1、关系代数语法书的构建方法：**输入，算法，输出**

> 1、把结果关系作为树根
>
> 2、把关系操作作为树的中间结点
>
> 3、把原始关系作为树叶
>
> **4、每个关系操作的子节点数目必须与其运算对象的个数一致。**

2、关系代数表达式等价变换规则

<u>关系代数优化以关系代数表达式的等价变换作为依据。</u>

> 1、规则4：选择的串接定律：选择条件可以合并，可以分解
>
> 2、规则6：选择与笛卡儿积的交换定律：使得部分选择在笛卡尔积之前先做

3、<font color=red>★★关系代数优化算法示例★★</font>

> TIP：考试时，只需要画两个图，一个是初始的，一个是优化结束的。
>
> 1、写出问题的初始关系代数
>
> 2、初试查询语法树
>
> 4、选择串接规则，分解选择条件
>
> 5、根据选择与笛卡儿积的交换定律，将选择向下交换
>
> 6、如果与如果有等值选择条件，那么将**笛卡尔乘积**与其后的**选择**操作组合成**连接**操作。
>
> 7、最后加上相应的投影，之前可以不考虑，最后统一加。

4、查询树的启发式优化

> 1、选择运算尽可能先做
>
> **2、投影运算与选择运算同时进行。**
>
> 3、<font color='red'>连接，特别是等值连接，优于笛卡儿积。</font>

## 数据库设计（15分）

ER图与关系模型之间的转换

★★★两个重点：

* 1:n，为n关系中，外码所参照为1的关系，**外码要写，容易忽略**。
* m:n，生成一个新关系

## 并发控制 （10）可串行化

1、判断是否调度是否可串行化

2、已知事务，给出可串行化的调度：

> 建议考虑两段锁协议保证可传性化，注意不同事务对统一数据对象加锁的时候，S锁应该加在X锁之后，这样会形成等待，同时，不会产生死锁。